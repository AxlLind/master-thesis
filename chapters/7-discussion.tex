\chapter{Discussion} \label{ch:discussion}
This chapter contains a discussion about the methodology used in this report and discussion of the results found in chapter \ref{ch:pentesting}. Lastly, a mandated discussion about the sustainability and ethics of this project is presented.

\section{Methodology}
The methodology used in this report is described extensively in chapter \ref{ch:method}. Largely, the methodology applied in this thesis was effective. It gave a clear structure to follow and the threat model gave insights into what type of vulnerabilities to consider. If one were to blindly guess and pentest the system without any structure, one could miss some obvious threats. By following established attack libraries like the OWASP IoT Top 10 \cite{owasp-iot-top10} (see section \ref{ch:related-work:owasp}) and the ETSI EN 303 645 standard, it was easier to identify reasonable vulnerabilities to explore. Otherwise, one could quite easily get caught in dead ends with low chances of success.

A seven-step penetration testing methodology described by Weidman \cite{weidman2014} was applied in this thesis. It was intuitive and easy to follow. However, one downside was that it perhaps was a bit excessive for this type of project. Being time constraint was a constant theme during this thesis. Things had to be continuously delimited as the project went on and the deadline approached. Steps like ranking each threat using the DREAD model, for example, was suggested in the methodology but was decided to not be worth it for such a time-limited project. Since there were more promising threats to examine than there was time, a more intuitive approach was used when deciding on what threats to focus on. Another downside was the inexperience of the author when it comes to threat modeling and pentesting methodology. It is not something that had been covered previously in the education at KTH. Therefore, a lot of the initial time of the thesis was spent on researching this area.

Overall, however, the methodology was very effective and gave good results. It gave structure to the penetration testing phase, which is otherwise often driven by intuition and probing the system looking for common sources of vulnerabilities. This is often the case during ethical hacking.

\section{Results}
The results from the penetration testing show that the system, in its current firmware version, unfortunately, cannot be considered secure. It is clear that some considerable thought has gone into the security of the system by the manufacturer. The system features tamper sensors to protect against physical attacks, it has a backup battery to guard against power outages, and it uses 3G telecommunication so as to not rely on the connectivity of the local network. Even on the RF level, some attention has been given to security. The system is able to detect RF jamming and implements some kind of encryption or obfuscation. However, none of that matters. When something as trivial as a replay attack is not protected against and has such critical consequences, it makes all of the other security measures irrelevant. They are completely negated.

These results are made even more severe considering that the critical vulnerability is what is known as a \enquote{zero knowledge} attack. It requires no knowledge about the system and RF protocol from the attacker. Anyone with 350 USD left over to buy an SDR, and some very basic technical competence could perform the attack. Tools like \textit{Universal Radio Hacker} \cite{urh} presents this process visually through an easy-to-use GUI, making it approachable to almost anyone. The reassurance, however, is that it requires capturing a live signal, e.g. someone actually leaving the house and arming the system. This requires some dedication from the attackers, waiting potentially a long time until the right moment. It also requires physical proximity, however, that is already a given if one wants to enter a property.

Additionally, the results revealed several other promising avenues to explore in the system. For example, it hosts a suspicious network service, on \textit{58098/tcp}. This is quite worrying, as insecure network services is one of the most common vulnerabilities against IoT systems \cite{owasp-iot-top10}. While this application could not be reverse-engineered in this project, one might be able to if the firmware of the system was acquired. There is potential that this could cause additional severe vulnerabilities. Additionally, one could potentially reverse engineer the RF protocol by analyzing the firmware and thus be able to construct and transmit arbitrary messages. More on this in section \ref{ch:conclusion:related-work}.

The results are reliable. Each penetration test was grounded in an extensive background section, and they were all successfully repeated multiple times.

\section{Sustainability and Ethics}
In the field of computer security, ethical concerns are always present. The findings of penetration testing, or hacking, could have huge consequences and could in some cases be incredibly damaging to the target. This makes ethical concerns relevant when performing penetration testing and security analysis. One has to take great care when hacking so as to not harm or disrupt. When a vulnerability is discovered another ethical concern emerges, namely how to ethically disclose it. There are three primary ways of handling a vulnerability from the point of view of a hacker \cite{disclosure-guideline}.
\begin{itemize}
    \item \textbf{Full disclosure}. The attacker makes the vulnerability fully public, without consulting the other party.
    \item \textbf{Non-disclosure}. The attacker does not disclose the vulnerability and potentially sells or uses it themselves for their gain.
    \item \textbf{Coordinated Vulnerability Disclosure (CVD)}. A coordinated disclosure of the vulnerability together with the affected party.
\end{itemize}
The third one, CVD, is \enquote{expressly preferred} \cite{disclosure-guideline} and the only ethical choice. CVD aims to increase the security of IT systems in general by properly disclosing vulnerabilities. This increases the body of knowledge of the industry and lets the industry learn from other people's mistakes. At the same time, it requires a dialog with the affected party and that both parties agree on how to deal with the vulnerability and how it will be reported. It is standard practice in cybersecurity to give the affected party at least 90 days to develop and ship a security patch. If the other party is unresponsive, dismisses the vulnerability, or decides to not produce a patch within 90 days then you should publicize the vulnerability anyway. The cornerstone of CVD is that the knowledge about the vulnerability be made publicly available eventually \cite{disclosure-guideline}.

Another ethical aspect of this project was making sure the law was followed. Penetration testing a system without the owner's permission is highly illegal in Sweden \cite{brottsbalken-it-brott}. Careful thought had to be put into making sure the law was followed during this thesis. For example, during the initial system selection process products from the companies Verisure and SectorAlarm were considered. However, through contacting their support it was made clear that they would continue to own the physical system and require a technician to install the system on the premise. This would make it illegal to security test the system without being given explicit permission from those companies. Additionally, this law means that security testing the cloud servers that the system communicates with, or functionality of the website and mobile app could be illegal. Therefore, this was a cause for delimitation of some aspects of the system.

Furthermore, sustainability is a concept that contains many different aspects, such as environmental and societal sustainability. The environmental connection to this project is negligible. A new system was procured, perhaps putting stress on the environment by manufacturing a system that was not intended to be used for a real practical purpose. However, that was a single purchase, and both the alarm system and the HackRF One SDR will be reused for future student thesis projects at KTH. Societal aspects, however, are more present. Our society is getting more and more digitized every year. Even large-scale infrastructure like the electric grid is now controlled by digital systems and is susceptible to cyber-attacks which can have \textit{devastating} consequences. This is already a present threat to our society. In December of 2015, a cyber attack was launched on the Ukraine power grid, leaving over 200 thousand people without electricity for several hours \cite{urkaine-power-grid-analysis}. This project, and all research within ethical hacking, arguably bring attention, knowledge, and resources to the field and work to increase our digital security, which is only getting more and more important by the year.
