\chapter{Related work} \label{ch:related-work}
This chapter describes identified related works done in the same area and specifically against the hardware used in the system. The OWASP IoT Top 10 is described as well as its relevance to this report. Additionally, the ETSI EN 303 645 standard for development of secure IoT products is covered. Regarding the system under consideration, very little has been published regarding the cybersecurity of this specific IoT system, as far as the author is aware. Two sources that explore systems based on the hardware from the same manufacturer, Climax Technology, have been identified. Additionally, a student thesis was done on a similar system but from a different manufacturer. These are presented below.

\section{OWASP IoT Top 10} \label{ch:related-work:owasp}
The OWASP top 10 for web vulnerabilities is one of the most used sources of the most common web vulnerabilities \cite{owasp-www-top10}. The OWASP Foundation, the publisher of the report, claims it is \enquote{globally recognized by developers as the first step towards more secure coding}\footnotelink{https://owasp.org/www-project-top-ten/}{2021-05-21}. OWASP also compiles and publishes a list of the top ten most common vulnerabilities for specifically IoT systems \cite{owasp-iot-top10}. The latest revision was released in \citeyear{owasp-iot-top10}. This list is highly relevant to this report as the system in question is an IoT system. It was used to identify and determine the most important threats to investigate. The top ten vulnerabilities for IoT systems according to OWASP's report are the following, in order of importance:
\begin{enumerate}
    \item \textbf{Weak, Guessable, or Hardcoded Passwords}. This includes passwords that can be easily brute-forced, are publicly available, or unchangeable. Famously the MIRAI botnet, which mostly included IoT devices, managed to recruit over half a million devices to its botnet by testing just 60 default credentials \cite{understanding-mirai}.
    
    \item \textbf{Insecure Network Services}. Often unneeded network services will be left open on IoT devices, even after they are shipped to customers. Commonly, these are used during development but are never removed when the device is shipped. An example is open telnet services or ssh being left open, leaving a backdoor open for the manufacturer. However, these network services also open the device up to a whole slew of potential vulnerabilities and are often completely unnecessary for the functionality of the IoT system. A real-world example of this is again the MIRAI botnet, which scanned IP ranges for devices with telnet services hosted on port 21 or 2121 \cite{understanding-mirai}.
    
    \item \textbf{Insecure Ecosystem Interfaces}. Many IoT systems are much more than just the device itself. There is often an entire infrastructure behind it to control and interact with the system, such as a mobile application or a website, with an accompanying backend API server. Vulnerabilities anywhere in this ecosystem can lead to the security of the IoT device itself being compromised.
    
    \item \textbf{Lack of Secure Update Mechanism}. To add new features and to fix security issues, updating the firmware of IoT devices is often unavoidable. However, over-the-air (OTA) firmware updates add an additional attack vector and can introduce many potential security issues. This can include the device not validating the firmware it receives, delivering the firmware unencrypted in transit, a lack of a mechanism to prevent rolling back changes, and a lack of notifications of security changes due to updates.
    
    \item \textbf{Use of Insecure or Outdated Components}. This means using old versions of libraries and components that themselves are vulnerable. These can then in turn compromise the security of the system as a whole. This can include everything from insecure versions of operating systems, insecure customization of the OS, third-party software, and insecure hardware components from higher up in the supply chain.
    
    \item \textbf{Insufficient Privacy Protection}. This refers to the user's personal information being stored in an insecure way. Either on the IoT system itself or in the larger ecosystem.
    
    \item \textbf{Insecure Data Transfer and Storage}. Lack of encryption or proper access control, both in transit and in storage. This can, once again, be both on the IoT device and anywhere else in the larger ecosystem.
    
    \item \textbf{Lack of Device Management}. This includes lack of secure asset management, update management, secure decommissioning of the system, proper monitoring of the system, as well as capabilities to respond to a security issue.
    
    \item \textbf{Insecure Default Settings}. This refers to the device being sold with insecure default settings. Often the user is never prompted or encouraged to change these insecure defaults.
    
    \item \textbf{Lack of Physical Hardening}. During development, debug hardware interfaces are used. However, a common vulnerability is not removing these before shipping the product. This can include open JTAG or UART interfaces on the circuit board, allowing for the extraction of the firmware or even terminal access to the system over a serial interface. Often these vulnerabilities require physical access to the system. However, they can be used to extract valuable information which can help an attacker in developing remote exploits.
\end{enumerate}
Note that some of these threats were not considered in this report. Some of these fall under the delimited areas described in section \ref{ch:intro:delimitations}, such as number three for example. Others were not considered simply due to time constraints. However, the OWASP IoT top 10 list was the basis for the identified threats against the system, along with the STRIDE model described in section \ref{ch:method:stride}.

\section{ETSI EN 303 645, a standard for IoT security of consumer products} \label{ch:related-work:etsi}
The \textit{European Telecommunications Standards Institute} (ETSI) is a standardization organization within information and communication technology (ICT). It is responsible for standardizing key technologies like GSM, 3G, 4G, and 5G. One of the standards produced by ETSI is of relevance to this report. In their standard \citetitle{etsi-iot-standard}, they list 13 provisions that should be followed by manufacturers selling consumer facing IoT products \cite{etsi-iot-standard}. While following the standard is certainly not a guarantee that the system is secure, it provides a set of best practices of common security issues to avoid in IoT systems. Within the provisions are sub-provisions which will not be covered in full detail here. What follows is an overview of the 13 provisions as outlined by ETSI \cite{etsi-iot-standard}.
\begin{enumerate}
    \item \textbf{No universal default passwords}. All passwords have to be either supplied by the user or unique per device. No password should work across all devices. Additionally, they warn against schemes were the password is generated using publicly available information like the systems MAC address or WiFi SSID.
    
    \item \textbf{Implement a means to manage reports of vulnerabilities}. The manufacturer should make publicly available a process for disclosing vulnerabilities. It should include contact information for disclosing security issues and information on timelines during a disclosure process.
    
    \item \textbf{Keep software updated}. The manufacturer needs to implement a way of sending out security patches in a timely manner and make sure that this done in reaction to discovered vulnerabilities.
    
    \item \textbf{Securely store sensitive security parameters}. This could be encrypted storage or dedicated security components implemented in hardware for example. Additionally, it states that hard-coded critical security parameters in the device software should not be used.
    
    \item \textbf{Communicate securely}. Best practices in encrypted communications should be used in all communication, including using reviewed and well-tested cryptography methods.
    
    \item \textbf{Minimize exposed attack surfaces}. The standard recommends adhering to the \textit{principle of least privilege}, meaning one should aim to give each actor the minimum privilege needed to perform its function. Additionally, it states that all unused or unnecessary network and logical interfaces should be disabled. Only software services that are absolutely required for the functionality of the device should be enabled.
    
    \item \textbf{Ensure software integrity}. The system should verify its firmware and other software by using secure boot mechanisms. Additionally, if a discrepancy is noted the system should report it to the user/administrator and should not connect to any wider network than the minimum required to send the notification.
    
    \item \textbf{Ensure that personal data is secure}. Personal data in transmit between devices should be properly secured using cryptography best practices.
    
    \item \textbf{Make systems resilient to outages}. Resilience should be built into the system, in terms of handling outages both in power and in network services for example. In case of a network failure the system should remain operational and keep the still viable functionality. In the event of a power loss the system should recover cleanly.
    
    \item \textbf{Examine system telemetry data}. If the system collects telemetry data it should be continuously monitored for anomalies with potential security implications.
    
    \item \textbf{Make it easy for users to delete user data}. It should be clear to the user how they can delete their data and functionality should be provided giving them access to do so. Additionally, users should be given clear notification of when their data has been deleted.
    
    \item \textbf{Make installation and maintenance of devices easy}. The installation and maintainence of the system should involve avoid decisions from the user as much as possible and follow security best practices on usability. Additionally, the manufacturer is responsible for providing adequate guidance on how to set up the system securely as well as how to check that it is set up securely.
    
    \item \textbf{Validate input data}. The system has to validate all inputs from any interface is reads from. It should never assume that the input is benign.
\end{enumerate}

\section{Related work 1: \textit{Examination of LUPUS-Electronics devices}} \label{ch:related-work:lupus}
This section details a security analysis of a very similar system, built on similar hardware from Climax Technology. The study was conducted by members of \textit{Embedded Lab Vienna for IoT \& Security} (ELVIS)\footnotelink{https://www.elvis.science/}{2021-04-09}, a project at the University of Applied Sciences Campus Vienna in Austria.

\textit{Lupus Electronics} is a German manufacturer of smart home security systems\footnotelink{https://www.lupus-electronics.de/en/}{2021-04-09}, much like \textit{Alarm.com} in the system examined in this thesis (see section \ref{ch:system:companies}). Just like Alarm.com, Lupus Electronics mostly provides the software of their system and also purchase hardware from the Taiwanese manufacturer \textit{Climax Technology}. In \citeyear{labvienna}, security researchers at ELVIS examined the security of the \textit{XT2 Plus Main Panel}. According to their report, similar hardware to the system examined in this thesis is used in that system. They reported several vulnerabilities. The most critical vulnerability they found was a Telnet server hosted on a non-standard high TCP port on the main panel. After examining the firmware of the system, and reverse engineering one of the applications, the researchers found that the password to the \texttt{root} user could be derived from a hardcoded salt and the MAC address of the panel. This meant that as long as an attacker had access to the local network, they could log in as root on the device, meaning with full privileges. With those privileges, one could easily bypass the security of the alarm completely.

While the Lupus system is not identical to the one in this thesis, much of the firmware from the hardware manufacturer is presumably the same. This assumption is strengthened by the fact that the endpoints found in the web interface of the Lupus system are the same in the thesis' system. The system under consideration in this report does not host a telnet server, however, it does host an application listening on a \textit{non-standard} high TCP port. According to their report, Climax Technology was notified about the vulnerabilities on \texttt{2019-01-09} and a firmware revision fixing the vulnerabilities was released on \texttt{2019-03-26}.

\section{Related work 2: \textit{The Internet of Things: a privacy label for IoT products in a consumer market}}
In their master thesis, author \citeauthor{iotprivacylabel} examines the design of an IoT privacy label, to help consumers recognize the security risks of the products they bring into their home \cite{iotprivacylabel}. The main objective of their thesis, while interesting, is not strictly relevant to this report. However, the thesis includes three case studies of different consumer products, one of them being highly relevant to this project. They examine the security of a home alarm system from \textit{Egardia}\footnotelink{https://www.egardia.com}{2021-04-12}, a dutch company producing smart home alarm systems. Much like \textit{Alarm.com} or \textit{Lupus Electronics} (see section \ref{ch:related-work:lupus}), Egardia are mainly responsible for the software platform and base their product on hardware from Climax Technology. While this system is not the main focus of their thesis, the author presents a short security analysis of the system and reports a few vulnerabilities. One of them, and arguably the most critical, is a replay attack vulnerability in the \gls{RF} communication between the remote keypad and the central panel. The author demonstrates how using a \gls{SDR} to capture the \gls{RF} traffic of the user arming and disarming the system, can be simply replayed. The system is then armed/disarmed without issue. There was to be no mechanism in place to prevent this type of attack. While the author labeled this a medium-level security vulnerability, it has the potential to completely subvert the functionality of the system. All it requires is physical proximity to the system and a \gls{SDR}, which can be bought by anyone for about 350 USD\footnotelink{https://greatscottgadgets.com/hackrf/one/}{2021-04-12}. Additional vulnerabilities in the system were related to the Egardia software platform and are therefore not relevant to this thesis.

Like the system covered in section \ref{ch:related-work:lupus}, the Egardia system uses different hardware to the system in this thesis. However, they come from the same manufacturer, Climax Technology, and they both communicate on the same radio frequency (868 MHz). There is strong reason to believe that they use the same underlying \gls{RF} protocol, a proprietary one from the hardware manufacturer called F1\footnotelink{https://www.climax.com.tw/new/f1-features-new.php}{2021-04-12}. This could mean that the system covered in this thesis is vulnerable to similar attacks on the \gls{RF} protocol.

\section{Related work 3: \textit{How Secure is Verisureâ€™s Alarm System?}}
In their thesis, authors \citeauthor{verisurethesis} examine the cybersecurity of a home alarm system from \textit{Verisure}. The company claims to sell the most widely installed home alarm in Europe\footnotelink{https://www.verisure.se/english}{2021-04-12}, installed in over 350 000 homes in Sweden alone. Their thesis mostly focuses on the SCTP communication between the main panel and the external Verisure servers, as well as the web security of the Verisure software platform. The authors found several \gls{CSRF} vulnerabilities, allowing an attacker to disarm the system and create new users.

The examined system from Versiure, from the point of view of a user, is similar to the one in this report. It offers almost the same components and features. From a technical perspective, however, the two systems are quite different. There is no overlap in the hardware components and much of the network technologies used are different. For example, the main panel in the Verisure system communicates over a broadband connection using the SCTP protocol, in contrast to the system in this thesis that uses 3G telecommunication. Their work does, however, show that the cybersecurity of similar products in the industry may be lacking.

\section{Related work 4: \textit{Hacking The IoT (Internet of Things) - PenTesting RF Operated Devices}} \label{ch:related-work:hacking-iot}
At the 2016 AppSecIL conference, an OWASP hosted conference on cyber security\footnotelink{https://appsecil.org/}{2021-06-05}, Erez Metula held a talk on RF hacking \cite{hacking-the-iot-talk}. In their talk they outline the basics of RF hacking, what tools you need, as well as how to approach reverse engineering a custom RF protocol. Metula is an application security expert, author of the book \textit{Managed Code Rootkits}, and a member of the OWASP IL Board.

Initially, the presenter talks about the common architecture of IoT systems. The IoT system will normally communicate with an external cloud server and some application that lets the user control the system, such as a mobile app or website. Additionally, for RF systems RF communication is used between local components. Furthermore, the concept of Software Defined Radio's (\gls{SDR}) is covered. Normally radio components will be implemented in hardware. However, these are physical devices that, through software, can emulate any radio component. This allows for much more flexibility and allows a hacker to tune it to the system under consideration. Metula discusses controlling an SDR using the open-source program \textit{GnuRadio Companion}, which lets the user create visual flow graphs to control an SDR.

The presenter goes on to discuss \textit{replay attacks} in RF communication. These are \enquote{zero knowledge} attacks, requiring no knowledge from the attacker about how the devices communicate, what protocols they use, etc. Instead, the attacker simply records a signal and replays the exact same signal later. If successful the system will recognize this as a valid signal and perform the same action again. The disadvantages of this type of attack, according to Metula, is that one cannot create a valid message from scratch, and one cannot tamper with and change the message.

To gain further insight into how the RF protocol works, Metula describes a seven step process to analyze the RF traffic to figure out the structure of the protocol and to be able to construct and transmit new messages:
\begin{enumerate}
    \item \textbf{Information gathering}. Initially, one needs to find out more information about the system. The presenter suggests using \gls{OSINT} techniques to gain more information. For example, usually the FCCID is written on the back of the device, or it can be found by looking at the manufactures website. By using publically available FCCID databases\footnotelink{https://fccid.io/}{2021-06-03}, one can find a lot of information about the RF aspects of the system. If one has the tools, Metula also suggests doing some hardware research. One can open up the device and look for serial/UART/JTAG interfaces on the PCB, which can potentially let you extract the firmware from the device for example.
    
    \item \textbf{Frequency}. Next one needs to find the operating frequency of the RF communication. Often this can be found in the FCC documentation, or one can use a spectrum analyzer to capture traffic and see where the devices communicate.
    
    \item \textbf{Modulation}. To transmit binary data over radio waves, a process called modulation is used. Finding out which modulation technique is used is vital to be able to extract the binary data out of a captured signal. This can either be found from official documentation, e.g the FCC documentation or user manuals, or by visually inspecting the captured signals.
    
    \item \textbf{Deviation}. If the system uses \gls{FSK} modulation then one needs to find the distance between the two frequencies.
    
    \item \textbf{Preamble/syncword}. According to Metula, RF protocols will often start with a preamble. The preamble is an alternating series of zeroes and ones. The purpose of the preamble is to sync the two devices and to let the receiver know that a message is starting. Following the preamble is often a syncword. This is a static string that indicates the start of the data section. It can also signify what protocol this is, or from what device it is. This can let the receiver drop the message if its not intended for them, for example if a system in the same proximity is communicating on the same frequency range.
    
    \item \textbf{Symbol rate}. Next one needs to find how many samples correspond to a single symbol, e.g a \texttt{1} or a \texttt{0}. If say you capture at a sample rate of \texttt{2 million samples/s}, each symbol might correspond to a few hundred samples. This depends on the sample rate and the baud rate of the devices.
    
    \item \textbf{Transmission}. From the previous steps you have all the information you need to transmit a new signal. Demodulating the signal, one can see the data of the packets. Often IoT systems lack any form of encryption in RF communication and instead simply send the data in plain text. If that is the case then reverse engineering the protocol and generating your own messages is not too difficult. Metula suggests creating a flowgraph in GnuRadio to transmit binary data according to the RF protocol. However, he notes that this is often quite complicated to create and is not very interactive. Another approach is using a commandline RF tool like RfCat, however it does not support all SDRs.
\end{enumerate}
The presenter goes on to discuss a common attack against RF communication, \textit{jamming}. In this type of attack the attacker continuously emits noise at a high decibel and at the operating frequency of the system one can block the traffic between the devices. One could for example prevent the message of arming the system from ever reaching the main panel. Metula likens this to a type of \gls{DOS} attack against RF systems. This can be done using an SDR with a very simple GnuRadio flowgraph. One can also use dedicated jammer devices which can jam much more effectively, however those are generally illegal to own.

\section{Related work 5: \textit{RF Exploitation: IoT and OT Hacking with Software-Defined Radio}} \label{ch:related-work:rf-exploit}
At the 2019 RSA Conference, an annual conference on computer security\footnotelink{https://www.rsaconference.com/}{2021-06-01}, a talk was given on RF hacking of IoT devices \cite{rf-exploitation-talk}. The presenters were \citeauthor{rf-exploitation-talk}, a researcher from MIT Academy of Engineering and security expert from the company Symantec respectively.

In the talk, they initially cover the IoT landscape, citing how the number of IoT devices is expected to grow 31 billion by 2020 and that the total IoT market is forecast to be valued at 520 billion USD by the year 2021. Additionally, they cover the typical IoT threat model, consisting of a multiple components. A controlling device, typically a smart phone. This device typically talks to a cloud service, which in turn is connected to a global network (e.g the internet). Lastly, the cloud service, using the global network, talks to and manages the "things". In this model, there is often a need for wireless communication and this is often achieved through radio frequency communication. The authors claim that the radio wave spectrum and RF communication is like the world wide web in the 90s, in terms of security, with obvious security flaws riddled all over the place.

The authors go on to outline a process for how to assess the RF security of a device. Initially, one has to establish how the device operates normally. How do they connect? What is the operating frequency? They present the phases of an RF attack as the following:
\begin{enumerate}
    \item \textbf{Information gathering}. Use \gls{OSINT} techniques like the FCC submission to find information about the device. If you are luck this could include documentation detailing at what frequency the device communicates, with what modulation etc.
    
    \item \textbf{Frequency}. Using programs like GQRX\footnotelink{https://gqrx.dk/}{2021-06-01} to analyze the frequency spectrum from a Software Defined Radio (SDR). By analyzing the spectrum while the devices are communicating one can find the center frequency.
    
    \item \textbf{Modulation}. Modulation is the technique of encoding binary data in a radio carrier wave. There are three basic types. In this step one has to figure out which modulation scheme the system uses by either visually inspecting the recorded signals from your SDR or through official documentation discovered in the first step.
    
    \item \textbf{Transmission}. When you know the frequency and modulation type you can now send arbitrary signals to the device. They mention tools the GnuRadio\footnotelink{https://www.gnuradio.org/}{2021-06-01} and the RfCat library\footnotelink{https://github.com/atlas0fd00m/rfcat}{2021-06-01} to do so.
\end{enumerate}
Furthermore, the presenters then cover one of the most common attacks against RF communication, replay attacks. This type of attack is a \enquote{zero knowledge} attack, meaning the attacker needs no knowledge of how the protocol works or how the devices communicates. If vulnerable, an attacker can simply record a signal and replay it at a later time to achieve the result again. Another advantage they list is that it works even if the protocol is encrypted. To understand the protocol the presenters talk about demodulating the signal using the open source audio processing tool Audacity\footnotelink{https://www.audacityteam.org/}{2021-06-01}. By demodulating a captured signal you get out the binary data that is sent between the devices. By analyzing the resulting bit pattern one can start to understand how the protocol is structured and what kind of information is being sent.

The presenters list five common attacks against RF protocols. One of them is replay attacks, as covered in the previous paragraph. Another one is a jamming attack, where the attacker sends out noise on the same frequency band which blocks legitimate traffic. To simply listen in on traffic is another attack they cover. Since the radio frequency band is an open medium, one needs encryption to protect against these types of information leaking vulnerabilities. However, the fact that two devices \textit{are communicating} is not possible to hide. \textit{Wardriving} is another attack they discuss. This is common against WiFi networks for example where an attacker simply drives around in their car with an RF receiver and scans for open networks and active RF traffic. Lastly, they discuss an \textit{evil-twins attack}. This is when an attacker sets up a device that mimics an access point in the network, for example a GSM network tower.

This talk largely echoes the sentiment of the talk covered in section \ref{ch:related-work:hacking-iot}. Their method for analyzing an RF device is almost identical and they both mention the same type of attacks and threats, giving credence to both.
